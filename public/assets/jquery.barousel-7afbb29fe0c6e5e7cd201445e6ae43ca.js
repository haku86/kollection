/*=============================    
jquery.barousel.js 
v.0.1
Julien Decaudin - 03/2010
www.juliendecaudin.com
=============================*/
(function(e){e.fn.barousel=function(n){var r=e.extend({imageWrapper:".barousel_image",contentWrapper:".barousel_content",contentLinksWrapper:null,navWrapper:".barousel_nav",slideDuration:5e3,navType:1,fadeIn:1,fadeInSpeed:600,manualCarousel:0,contentResize:1,contentResizeSpeed:300,debug:0},n||{});r.imageWrapper=e(this).find(r.imageWrapper),r.contentWrapper=e(this).find(r.contentWrapper),r.contentLinksWrapper=e(r.contentLinksWrapper),r.navWrapper=e(this).find(r.navWrapper),r.imageList=r.imageWrapper.find("img").not("[class*=intro]"),r.contentList=r.contentWrapper.find("div").not("[class*=intro]"),r.contentLinksList=r.contentLinksWrapper.find("a"),r.imageIntro=r.imageWrapper.find("img[class*=intro]"),r.contentIntro=r.contentWrapper.find("div[class*=intro]"),r.currentIndex=0,r.totalItem=r.imageList.length,r.stopCarousel=0,r.timerCarousel,r.navFreeze=0,r.introActive=0,r.imageWrapper.find("img[class*=intro]").length>0&&(r.introActive=1);if(r.totalItem!=1){r.imageList.each(function(e){this.index=e}),r.contentList.each(function(e){this.index=e}),r.contentLinksList.each(function(e){this.index=e});if(r.imageList.length!=r.contentList.length)return r.debug==1&&console.log("[Barousel error] images and contents must be the same number"),this;r.contentResize==1&&r.introActive==0&&e(r.contentWrapper).height(e(r.contentList[r.currentIndex]).height()+10),r.contentLinksWrapper!=null&&e(r.contentLinksList[r.currentIndex]).addClass("current");if(r.navType==1){var i="<ul>";r.imageList.each(function(t){var n="";t==0&&(n="current"),i+="<li><a href='#' title='"+e(r.contentList[t]).find("p.header").text()+"' class='"+n+"'>&nbsp;</a></li>"}),i+="</ul>",r.navWrapper.append(i),r.navList=r.navWrapper.find("a"),r.navList.each(function(e){this.index=e})}else if(r.navType==2){var i="<ul>";i+="<li class='prev'><a href='#' title='previous'>&nbsp;</a></li>",i+="<li class='next'><a href='#' title='next'>&nbsp;</a></li>",i+="</ul><div class='counter'><span class='counter_current'>1</span>/<span class='counter_total'>"+r.totalItem+"</span></div>",r.navWrapper.append(i),r.navList=r.navWrapper.find("a")}else r.navType==3&&(r.navList=r.navWrapper.find("a"),r.navList.each(function(e){this.index=e}));r.navType==1||r.navType==3?r.navList.each(function(n){e(this).click(function(){if(r.navFreeze==0){window.clearTimeout(r.timerCarousel),r.stopCarousel=1;if(r.currentIndex!=n||r.introActive==1)t(r,n),r.currentIndex=n}return r.introActive=0,!1})}):r.navType==2&&r.navList.each(function(){e(this).click(function(){if(r.navFreeze==0){window.clearTimeout(r.timerCarousel),r.stopCarousel=1;if(e(this).parent().hasClass("prev")){var n;parseInt(r.currentIndex)==0?n=parseInt(r.totalItem)-1:n=parseInt(r.currentIndex)-1,t(r,n),r.currentIndex=n}else if(e(this).parent().hasClass("next")){var i;parseInt(r.currentIndex)==parseInt(r.totalItem)-1?i=0:i=parseInt(r.currentIndex)+1,t(r,i),r.currentIndex=i}}return r.introActive=0,!1})});if(r.manualCarousel==0){var s=function(){t(r,1)};r.timerCarousel=window.setTimeout(s,r.slideDuration)}}return this};var t=function(r,i){r.navType!=2&&(r.navList.each(function(t){e(this).removeClass("current")}),e(r.navList[i]).addClass("current"));var s;r.introActive==1?s=e(r.imageIntro):s=e(r.imageList[r.currentIndex]);var o=e(r.imageList[i]);r.debug==1&&(console.log("[Barousel loadItem] currentImage:"+s.attr("src")),console.log("[Barousel loadItem] nextImage:"+o.attr("src"))),s.hasClass("default")||s.attr("class","previous"),o.attr("class","current"),r.fadeIn==0?(o.show(),s.hide(),n(r,i)):(r.navFreeze=1,e(r.contentList).hide(),o.fadeIn(r.fadeInSpeed,function(){s.hide(),s.removeClass("previous"),r.navFreeze=0}),n(r,i));if(r.stopCarousel==0){r.currentIndex=i;var u;r.currentIndex==r.totalItem-1?u=0:u=parseInt(r.currentIndex)+1;var a=function(){t(r,u)};r.timerCarousel=window.setTimeout(a,r.slideDuration)}},n=function(t,n){t.introActive==1&&(e(t.contentIntro).hide(),e(t.contentWrapper).attr("class","")),t.contentResize==1&&parseInt(e(t.contentWrapper).height())!=parseInt(e(t.contentList[n]).height()+10)?e(t.contentWrapper).animate({height:e(t.contentList[n]).height()+10},t.contentResizeSpeed,function(){r(t,n)}):r(t,n),t.navType==2&&e(t.navWrapper).find(".counter_current").text(n+1)},r=function(t,n){e(t.contentList).hide(),e(t.contentList[n]).show(),t.contentLinksWrapper!=null&&(e(t.contentLinksList).removeClass("current"),e(t.contentLinksList[n]).addClass("current"))}})(jQuery);